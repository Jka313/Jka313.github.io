<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JKA5 | REAL INTEL v12.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg: #050505;
            --win-bg: rgba(15, 15, 15, 0.95);
            --neon-green: #00ff41; 
            --neon-cyan: #00f3ff;
            --alert: #ff003c;
            --font-code: 'Fira Code', monospace;
            --font-ui: 'Cairo', sans-serif;
        }

        * { box-sizing: border-box; user-select: none; outline: none; }
        body { margin: 0; overflow: hidden; background: #000; font-family: var(--font-code); color: var(--neon-green); }

        /* SCANLINES */
        .scanlines { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: repeating-linear-gradient(0deg, rgba(0,0,0,0.15), rgba(0,0,0,0.15) 1px, transparent 1px, transparent 2px); pointer-events: none; z-index: 9999; }

        /* DESKTOP */
        #desktop { position: relative; width: 100vw; height: 100vh; background: radial-gradient(circle at center, #0a0f0a 0%, #000 100%); overflow: hidden; }
        #matrixCanvas { position: absolute; top: 0; left: 0; opacity: 0.15; z-index: 0; pointer-events: none; }

        /* TASKBAR */
        .taskbar {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 50px;
            background: rgba(10,10,10,0.95); border-top: 1px solid #333;
            display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 200;
        }
        .sys-info { font-size: 12px; color: #888; }

        /* ICONS */
        .desktop-icons { position: absolute; top: 40px; left: 40px; display: flex; flex-direction: column; gap: 30px; z-index: 10; }
        .icon { width: 90px; text-align: center; cursor: pointer; opacity: 0.8; transition: 0.2s; }
        .icon:hover { opacity: 1; transform: scale(1.1); text-shadow: 0 0 10px var(--neon-green); }
        .icon i { font-size: 32px; margin-bottom: 8px; display: block; color: #e0e0e0; }
        .icon span { background: rgba(0,0,0,0.7); padding: 3px 6px; border-radius: 4px; font-size: 11px; font-family: var(--font-ui); }

        /* WINDOWS */
        .window {
            position: absolute; background: var(--win-bg); border: 1px solid var(--neon-green);
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.1); display: none; flex-direction: column;
            z-index: 50; border-radius: 5px; overflow: hidden; backdrop-filter: blur(5px);
        }
        .win-header {
            padding: 8px 15px; background: rgba(255,255,255,0.05); border-bottom: 1px solid #333;
            cursor: grab; display: flex; justify-content: space-between; align-items: center;
        }
        .win-title { font-size: 12px; font-weight: bold; text-transform: uppercase; display: flex; align-items: center; gap: 8px; }
        .win-controls span { cursor: pointer; margin-left: 10px; font-size: 14px; color: #666; }
        .win-controls span:hover { color: var(--alert); }
        .win-body { flex: 1; overflow: hidden; position: relative; color: #ccc; font-size: 13px; }

        /* REAL NEWS STYLES */
        #news-feed { padding: 15px; height: 100%; overflow-y: auto; }
        .news-card {
            display: flex; gap: 15px; margin-bottom: 15px; padding: 10px;
            background: rgba(0, 255, 65, 0.05); border-left: 3px solid var(--neon-green);
            transition: 0.3s; cursor: pointer;
        }
        .news-card:hover { background: rgba(0, 255, 65, 0.1); transform: translateX(5px); }
        .news-img { width: 80px; height: 60px; object-fit: cover; border: 1px solid #333; opacity: 0.8; }
        .news-info { flex: 1; }
        .news-title { font-weight: bold; font-size: 13px; color: #fff; margin-bottom: 5px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;}
        .news-date { font-size: 10px; color: var(--neon-cyan); }
        
        /* LOADING SPINNER */
        .loader { text-align: center; padding-top: 50px; color: var(--neon-green); }

        /* Terminal */
        #term-content { padding: 15px; height: 100%; overflow-y: auto; font-family: var(--font-code); }
        .prompt { color: var(--neon-cyan); margin-right: 5px; }

        /* Scrollbars */
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: var(--neon-green); }
    </style>
</head>
<body>
    <div class="scanlines"></div>

    <div id="desktop">
        <canvas id="matrixCanvas"></canvas>

        <div class="desktop-icons">
            <div class="icon" onclick="openWindow('news')">
                <i class="fas fa-rss" style="color:var(--neon-cyan)"></i>
                <span>Global Feed</span>
            </div>
            <div class="icon" onclick="openWindow('term')">
                <i class="fas fa-terminal"></i>
                <span>Terminal</span>
            </div>
            <div class="icon" onclick="location.reload()">
                <i class="fas fa-sync-alt" style="color:#fff"></i>
                <span>Reboot System</span>
            </div>
        </div>

        <div id="win-news" class="window" style="top: 60px; left: 200px; width: 700px; height: 500px;">
            <div class="win-header" onmousedown="dragWindow(this.parentElement, event)">
                <div class="win-title"><i class="fas fa-satellite-dish"></i> THE HACKER NEWS (LIVE)</div>
                <div class="win-controls">
                    <span onclick="fetchRealNews()"><i class="fas fa-sync"></i></span>
                    <span onclick="closeWindow('win-news')">✖</span>
                </div>
            </div>
            <div class="win-body" id="news-feed">
                </div>
        </div>

        <div id="win-term" class="window" style="top: 120px; left: 250px; width: 600px; height: 400px;">
            <div class="win-header" onmousedown="dragWindow(this.parentElement, event)">
                <div class="win-title"><i class="fas fa-terminal"></i> ROOT SHELL</div>
                <div class="win-controls"><span onclick="closeWindow('win-term')">✖</span></div>
            </div>
            <div class="win-body" id="term-content" onclick="document.getElementById('cmd').focus()">
                <div>JKA5 Real-Time OS v12.0</div>
                <div>Connected to Global News Network.</div>
                <br>
                <div id="term-log"></div>
                <div style="display:flex">
                    <span class="prompt">root@jka5:~#</span>
                    <input type="text" id="cmd" style="background:transparent; border:none; color:#fff; width:100%; font-family:var(--font-code);" autofocus autocomplete="off">
                </div>
            </div>
        </div>

        <div class="taskbar">
            <div style="font-weight:bold;"><i class="fas fa-network-wired"></i> JKA5 ONLINE</div>
            <div class="sys-info">
                <span id="ip-addr">IP: DETECTING...</span> | 
                <span id="clock">00:00:00</span>
            </div>
        </div>
    </div>

    <script>
        // ================= CORE INIT =================
        window.onload = function() {
            startMatrix();
            updateClock();
            getIP();
            openWindow('news'); // فتح الأخبار تلقائياً
            fetchRealNews(); // جلب الأخبار الحقيقية
        };

        // ================= 1. REAL NEWS FETCHER (RSS to JSON) =================
        // نستخدم خدمة rss2json لتحويل رابط الأخبار إلى بيانات يفهمها الموقع
        const RSS_URL = "https://feeds.feedburner.com/TheHackersNews"; 
        const API_ENDPOINT = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(RSS_URL)}`;

        async function fetchRealNews() {
            const feed = document.getElementById('news-feed');
            const termLog = document.getElementById('term-log');
            
            feed.innerHTML = `
                <div class="loader">
                    <i class="fas fa-circle-notch fa-spin" style="font-size:24px"></i><br><br>
                    CONNECTING TO SATELLITE FEED...<br>
                    DOWNLOADING INTEL...
                </div>
            `;

            try {
                const res = await fetch(API_ENDPOINT);
                const data = await res.json();

                if(data.status === 'ok') {
                    feed.innerHTML = ''; // مسح التحميل
                    
                    data.items.forEach(item => {
                        // استخراج صورة إن وجدت أو وضع صورة افتراضية
                        let img = item.thumbnail || 'https://upload.wikimedia.org/wikipedia/commons/d/d9/Icon-round-Question_mark.svg';
                        
                        const card = document.createElement('div');
                        card.className = 'news-card';
                        card.onclick = () => window.open(item.link, '_blank');
                        
                        card.innerHTML = `
                            <img src="${img}" class="news-img" onerror="this.src='https://via.placeholder.com/80?text=JKA5'">
                            <div class="news-info">
                                <div class="news-title">${item.title}</div>
                                <div class="news-date"><i class="fas fa-clock"></i> ${item.pubDate}</div>
                            </div>
                        `;
                        feed.appendChild(card);
                    });

                    // كتابة في التيرمينال
                    termLog.innerHTML += `<div style="color:#0f0">[+] Fetched ${data.items.length} new articles from The Hacker News.</div>`;
                
                } else {
                    throw new Error("Feed Error");
                }
            } catch (e) {
                feed.innerHTML = `<div style="color:red; text-align:center; padding:20px;">CONNECTION FAILED. RETRYING...</div>`;
                termLog.innerHTML += `<div style="color:red">[-] API Error: ${e.message}</div>`;
            }
        }

        // ================= 2. IP DETECTOR =================
        async function getIP() {
            try {
                const res = await fetch('https://api.ipify.org?format=json');
                const data = await res.json();
                document.getElementById('ip-addr').innerText = `IP: ${data.ip}`;
                document.getElementById('ip-addr').style.color = "#00f3ff";
            } catch(e) {
                document.getElementById('ip-addr').innerText = "IP: HIDDEN (VPN)";
            }
        }

        // ================= UTILS & UI =================
        function updateClock() {
            document.getElementById('clock').innerText = new Date().toLocaleTimeString();
            setTimeout(updateClock, 1000);
        }

        // Terminal Logic
        const cmd = document.getElementById('cmd');
        const log = document.getElementById('term-log');
        cmd.addEventListener('keypress', (e) => {
            if(e.key === 'Enter') {
                const val = cmd.value.toLowerCase();
                log.innerHTML += `<div>root@jka5:~# ${cmd.value}</div>`;
                if(val === 'refresh') fetchRealNews();
                else if(val === 'clear') log.innerHTML = '';
                else if(val === 'exit') window.close();
                else log.innerHTML += `<div style="color:#666">Command not found. Try 'refresh'.</div>`;
                cmd.value = '';
            }
        });

        // Window Dragging & Manager
        let zIndex = 100;
        function openWindow(id) {
            const win = document.getElementById('win-' + id);
            win.style.display = 'flex'; zIndex++; win.style.zIndex = zIndex;
        }
        function closeWindow(id) { document.getElementById(id).style.display = 'none'; }
        
        function dragWindow(elmnt, e) {
            e.preventDefault();
            let pos3=e.clientX, pos4=e.clientY;
            zIndex++; elmnt.style.zIndex = zIndex;
            document.onmouseup = closeDragElement;
            document.onmousemove = (e) => {
                e.preventDefault();
                let pos1=pos3-e.clientX, pos2=pos4-e.clientY;
                pos3=e.clientX; pos4=e.clientY;
                elmnt.style.top=(elmnt.offsetTop-pos2)+"px"; 
                elmnt.style.left=(elmnt.offsetLeft-pos1)+"px";
            };
            function closeDragElement() { document.onmouseup=null; document.onmousemove=null; }
        }

        // Matrix Background
        function startMatrix() {
            const c = document.getElementById("matrixCanvas");
            const ctx = c.getContext("2d");
            c.width = window.innerWidth; c.height = window.innerHeight;
            const chars = "01JKA5"; const drops = Array(Math.floor(c.width/20)).fill(1);
            setInterval(()=>{
                ctx.fillStyle="rgba(0,0,0,0.05)"; ctx.fillRect(0,0,c.width,c.height);
                ctx.fillStyle="#00ff41"; ctx.font="15px monospace";
                drops.forEach((y,i)=>{
                    ctx.fillText(chars[Math.floor(Math.random()*chars.length)],i*20,y*20);
                    if(y*20>c.height && Math.random()>0.98) drops[i]=0;
                    drops[i]++;
                });
            }, 50);
        }
    </script>
</body>
</html>
