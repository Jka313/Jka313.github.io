<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JKA5 | OS v6.0 (UTILITY)</title>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg: #050505;
            --win-bg: rgba(15, 15, 15, 0.95);
            --main-neon: #00ff41; 
            --neon-cyan: #00f3ff;
            --alert: #ff003c;
            --font-code: 'Fira Code', monospace;
            --font-text: 'Cairo', monospace;
        }

        * { box-sizing: border-box; user-select: none; outline: none; }
        body { margin: 0; overflow: hidden; background: var(--bg); font-family: var(--font-code); color: var(--main-neon); transition: color 0.5s; }
        
        /* Effects */
        .scanlines { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06)); background-size: 100% 2px, 3px 100%; pointer-events: none; z-index: 9999; opacity: 0.2; }

        /* Desktop */
        #desktop { position: relative; width: 100vw; height: 100vh; background: radial-gradient(circle at center, #0a0a0a 0%, #000 100%); }
        #matrixCanvas { position: absolute; top: 0; left: 0; opacity: 0.1; z-index: 0; pointer-events: none; }

        /* Taskbar */
        .taskbar {
            position: absolute; top: 0; left: 0; width: 100%; height: 45px;
            background: rgba(10,10,10,0.95); border-bottom: 1px solid #333;
            display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 100;
        }
        .start-btn { font-weight: bold; font-size: 16px; display: flex; align-items: center; gap:10px; text-shadow: 0 0 5px var(--main-neon); }
        .sys-tray { font-size: 12px; display: flex; gap: 15px; align-items: center; }
        .theme-dot { width: 15px; height: 15px; border-radius: 50%; cursor: pointer; border: 1px solid #444; }

        /* Icons */
        .desktop-icons { position: absolute; top: 70px; left: 30px; z-index: 10; display: flex; flex-direction: column; gap: 25px; }
        .icon { width: 90px; text-align: center; cursor: pointer; transition: 0.2s; opacity: 0.8; }
        .icon:hover { opacity: 1; transform: scale(1.1); text-shadow: 0 0 10px var(--main-neon); }
        .icon i { font-size: 32px; margin-bottom: 8px; color: #eee; display: block; }
        .icon span { font-size: 11px; background: rgba(0,0,0,0.6); padding: 3px 6px; border-radius: 4px; font-family: var(--font-text); }

        /* Windows */
        .window {
            position: absolute; width: 600px; min-height: 300px;
            background: var(--win-bg); border: 1px solid var(--main-neon);
            box-shadow: 0 0 40px rgba(0,0,0,0.8);
            display: none; flex-direction: column; z-index: 50;
            border-radius: 5px 5px 0 0; overflow: hidden;
        }
        .win-header {
            padding: 8px 15px; background: rgba(255,255,255,0.05);
            border-bottom: 1px solid #333; cursor: grab;
            display: flex; justify-content: space-between; align-items: center;
        }
        .win-title { font-weight: bold; font-size: 12px; text-transform: uppercase; display: flex; align-items: center; gap: 10px; }
        .btn-close { cursor: pointer; font-size: 16px; color: #666; }
        .btn-close:hover { color: var(--alert); }
        .win-body { flex: 1; overflow-y: auto; max-height: 500px; color: #ccc; font-size: 13px; }

        /* Specific Window Content */
        .tool-panel { padding: 20px; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; font-size: 12px; color: var(--neon-cyan); }
        .input-group textarea, .input-group input { 
            width: 100%; background: #000; border: 1px solid #333; color: var(--main-neon); 
            padding: 10px; font-family: var(--font-code); font-size: 12px; resize: vertical; 
        }
        .btn-action { 
            background: transparent; border: 1px solid var(--main-neon); color: var(--main-neon); 
            padding: 8px 20px; cursor: pointer; font-family: var(--font-code); font-weight: bold; transition: 0.3s;
        }
        .btn-action:hover { background: var(--main-neon); color: #000; }

        /* Terminal */
        #terminal-body { background: #0c0c0c; padding: 10px; font-family: var(--font-code); height: 100%; }
        .prompt { color: var(--main-neon); margin-right: 5px; }

        /* Notification */
        #notify-area { position: fixed; bottom: 20px; right: 20px; z-index: 9999; display: flex; flex-direction: column; gap: 10px; }
        .toast { 
            background: rgba(0, 20, 0, 0.95); border-left: 4px solid var(--main-neon); 
            padding: 15px 20px; width: 300px; color: #fff; font-size: 12px; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.5); animation: slideIn 0.3s ease-out;
            font-family: var(--font-text); display: flex; align-items: center; gap: 10px;
        }
        @keyframes slideIn { from {transform: translateX(100%)} to {transform: translateX(0)} }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: var(--main-neon); }
        ::-webkit-scrollbar-track { background: #111; }
    </style>
</head>
<body>
    <div class="scanlines"></div>

    <div id="desktop">
        <canvas id="matrixCanvas"></canvas>

        <div class="taskbar">
            <div class="start-btn"><i class="fas fa-terminal"></i> JKA5_OS v6.0</div>
            <div class="sys-tray">
                <div class="theme-dot" style="background:#00ff41" onclick="setTheme('#00ff41')"></div>
                <div class="theme-dot" style="background:#00f3ff" onclick="setTheme('#00f3ff')"></div>
                <div class="theme-dot" style="background:#ff003c" onclick="setTheme('#ff003c')"></div>
                <span style="border-left:1px solid #333; padding-left:15px;" id="clock">00:00</span>
            </div>
        </div>

        <div class="desktop-icons">
            <div class="icon" onclick="openWindow('win-term')">
                <i class="fas fa-terminal"></i>
                <span>Terminal</span>
            </div>
            <div class="icon" onclick="openWindow('win-crypto')">
                <i class="fas fa-lock"></i>
                <span>Crypto Tools</span>
            </div>
            <div class="icon" onclick="openWindow('win-pass')">
                <i class="fas fa-key"></i>
                <span>Pass Gen</span>
            </div>
            <div class="icon" onclick="openWindow('win-game')">
                <i class="fas fa-gamepad" style="color: #bd00ff;"></i>
                <span>Code Breaker</span>
            </div>
            <div class="icon" onclick="openWindow('win-browser')">
                <i class="fas fa-globe"></i>
                <span>JKA5 Browser</span>
            </div>
        </div>

        <div id="win-term" class="window" style="top: 80px; left: 150px; width: 700px; height: 450px;">
            <div class="win-header">
                <span class="win-title"><i class="fas fa-terminal"></i> ROOT@JKA5:~</span>
                <span class="btn-close" onclick="closeWindow('win-term')">‚úñ</span>
            </div>
            <div class="win-body" id="terminal-body" onclick="document.getElementById('term-input').focus()">
                <div>JKA5 OS v6.0 [Utility Update]</div>
                <div>Type <span style="color:var(--neon-cyan)">'help'</span>. Try filesystem commands: <span style="color:var(--neon-cyan)">ls, cd, mkdir, cat</span></div>
                <br>
                <div id="term-output"></div>
                <div style="display:flex">
                    <span class="prompt" id="prompt-text">root@jka5:~#</span>
                    <input type="text" id="term-input" style="background:transparent; border:none; color:var(--main-neon); flex:1; font-weight:bold;" autofocus spellcheck="false">
                </div>
            </div>
        </div>

        <div id="win-crypto" class="window" style="top: 120px; left: 300px; width: 500px;">
            <div class="win-header">
                <span class="win-title"><i class="fas fa-lock"></i> BASE64 DECODER/ENCODER</span>
                <span class="btn-close" onclick="closeWindow('win-crypto')">‚úñ</span>
            </div>
            <div class="win-body tool-panel">
                <div class="input-group">
                    <label>INPUT TEXT (ÿßŸÑŸÜÿµ ÿßŸÑŸÖÿØÿÆŸÑ):</label>
                    <textarea id="crypto-input" rows="3" placeholder="Enter text here..."></textarea>
                </div>
                <div style="display:flex; gap:10px; margin-bottom:15px;">
                    <button class="btn-action" onclick="doBase64('encode')">ENCODE (ÿ™ÿ¥ŸÅŸäÿ±)</button>
                    <button class="btn-action" onclick="doBase64('decode')">DECODE (ŸÅŸÉ ÿ™ÿ¥ŸÅŸäÿ±)</button>
                </div>
                <div class="input-group">
                    <label>OUTPUT RESULT (ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©):</label>
                    <textarea id="crypto-output" rows="3" readonly style="color:var(--neon-cyan)"></textarea>
                </div>
            </div>
        </div>

        <div id="win-pass" class="window" style="top: 160px; left: 400px; width: 400px;">
            <div class="win-header">
                <span class="win-title"><i class="fas fa-key"></i> SECURE PASSWORD GEN</span>
                <span class="btn-close" onclick="closeWindow('win-pass')">‚úñ</span>
            </div>
            <div class="win-body tool-panel">
                <div class="input-group">
                    <label>GENERATED PASSWORD:</label>
                    <input type="text" id="pass-output" readonly style="text-align:center; font-size:16px; letter-spacing:2px; color:#fff;">
                </div>
                <button class="btn-action" style="width:100%" onclick="generatePass()">GENERATE NEW</button>
            </div>
        </div>

        <div id="win-browser" class="window" style="top: 100px; left: 250px; width: 800px; height: 500px;">
             <div class="win-header">
                <span class="win-title"><i class="fas fa-globe"></i> JKA5 SECURE BROWSER</span>
                <span class="btn-close" onclick="closeWindow('win-browser')">‚úñ</span>
            </div>
            <div class="win-body" style="padding:0;">
                <div style="padding:10px; background:#222; border-bottom:1px solid #444; display:flex; gap:10px;">
                    <span style="color:#888">üîí https://jka5.xyz/intel-feed</span>
                </div>
                <div style="padding:20px;">
                    <h2 style="border-bottom:1px solid #444; padding-bottom:10px; color:var(--neon-cyan)">LATEST VULNERABILITIES (CVEs)</h2>
                    <div id="news-feed">
                        </div>
                </div>
            </div>
        </div>

        <div id="win-game" class="window" style="top: 200px; left: 500px; width: 350px;">
            <div class="win-header">
                <span class="win-title"><i class="fas fa-gamepad"></i> CODE BREAKER</span>
                <span class="btn-close" onclick="closeWindow('win-game')">‚úñ</span>
            </div>
            <div class="win-body tool-panel" style="text-align:center">
                <p>Guess the 3-digit code (000-999)</p>
                <input type="number" id="game-input" placeholder="???" style="width:100px; font-size:20px; text-align:center; margin-bottom:10px;">
                <br>
                <button class="btn-action" onclick="checkCode()">UNLOCK</button>
                <p id="game-msg" style="margin-top:10px; font-size:12px; color:#888"></p>
            </div>
        </div>

    </div>

    <div id="notify-area"></div>

    <script>
        // ================= 1. SYSTEM CORE =================
        function initOS() {
            updateClock();
            startMatrix();
            document.querySelectorAll('.window').forEach(dragElement);
            notify("System Loaded Successfully", "success");
            generatePass(); // Init password tool
            loadNews(); // Load news
            // Open Terminal by default
            setTimeout(()=>openWindow('win-term'), 500);
        }
        window.onload = initOS;

        function updateClock() {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            setTimeout(updateClock, 1000);
        }

        function setTheme(color) {
            document.documentElement.style.setProperty('--main-neon', color);
            startMatrix(color);
            notify("Theme Updated", "info");
        }

        function notify(msg, type) {
            const area = document.getElementById('notify-area');
            const toast = document.createElement('div');
            toast.className = 'toast';
            let icon = type === 'success' ? 'check-circle' : 'info-circle';
            toast.innerHTML = `<i class="fas fa-${icon}"></i> <span>${msg}</span>`;
            area.appendChild(toast);
            
            // Sound effect
            playBeep();

            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playBeep() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.frequency.value = 800;
            gain.gain.value = 0.05;
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.1);
        }

        // ================= 2. FILE SYSTEM SIMULATION =================
        // ŸÜÿ∏ÿßŸÖ ŸÖŸÑŸÅÿßÿ™ ŸàŸáŸÖŸä ŸÅŸä ÿßŸÑÿ∞ÿßŸÉÿ±ÿ©
        const fileSystem = {
            "home": {
                type: "dir",
                content: {
                    "user": {
                        type: "dir",
                        content: {
                            "notes.txt": { type: "file", content: "Remember to patch the server." },
                            "passwords.txt": { type: "file", content: "root:toor\nadmin:admin123" },
                            "scripts": { type: "dir", content: {} }
                        }
                    }
                }
            }
        };
        
        let currentPath = ["home", "user"]; // Start path

        const termInput = document.getElementById('term-input');
        const termOutput = document.getElementById('term-output');
        const promptText = document.getElementById('prompt-text');

        termInput.addEventListener('keypress', function(e) {
            if(e.key === 'Enter') {
                const rawCmd = this.value.trim();
                const args = rawCmd.split(" ");
                const cmd = args[0].toLowerCase();
                
                printTerm(promptText.innerText + " " + rawCmd);

                if(cmd === 'help') {
                    printTerm("Commands: ls, cd, cat, mkdir, clear, date, whoami");
                }
                else if(cmd === 'clear') {
                    termOutput.innerHTML = "";
                }
                else if(cmd === 'ls') {
                    const dir = getCurrentDir();
                    let output = "";
                    for(let key in dir.content) {
                        const isDir = dir.content[key].type === 'dir';
                        const style = isDir ? "color:var(--neon-cyan); font-weight:bold" : "color:#ccc";
                        output += `<span style="${style}">${key}${isDir?'/':''}</span>  `;
                    }
                    printTerm(output || "(empty)");
                }
                else if(cmd === 'mkdir') {
                    if(args[1]) {
                        const dir = getCurrentDir();
                        dir.content[args[1]] = { type: "dir", content: {} };
                        printTerm(`Directory '${args[1]}' created.`);
                    } else {
                        printTerm("Usage: mkdir <dirname>", "error");
                    }
                }
                else if(cmd === 'cat') {
                    if(args[1]) {
                        const dir = getCurrentDir();
                        if(dir.content[args[1]] && dir.content[args[1]].type === 'file') {
                            printTerm(dir.content[args[1]].content);
                        } else {
                            printTerm("File not found.", "error");
                        }
                    } else {
                        printTerm("Usage: cat <filename>", "error");
                    }
                }
                else if(cmd === 'cd') {
                    if(!args[1]) {
                        // do nothing
                    } else if(args[1] === "..") {
                        if(currentPath.length > 1) currentPath.pop();
                    } else {
                        const dir = getCurrentDir();
                        if(dir.content[args[1]] && dir.content[args[1]].type === 'dir') {
                            currentPath.push(args[1]);
                        } else {
                            printTerm("Directory not found.", "error");
                        }
                    }
                    updatePrompt();
                }
                else if(cmd === 'whoami') printTerm("root");
                else if(cmd === 'date') printTerm(new Date().toString());
                else printTerm("Command not found.", "error");

                this.value = "";
                scrollToBottom();
            }
        });

        function getCurrentDir() {
            let current = fileSystem;
            for(let p of currentPath) {
                current = current.content ? current.content[p] : current[p];
            }
            return current;
        }

        function updatePrompt() {
            promptText.innerText = `root@jka5:/${currentPath.join("/")}#`;
        }

        function printTerm(text, type="normal") {
            const div = document.createElement('div');
            div.innerHTML = text;
            if(type === 'error') div.style.color = 'var(--alert)';
            termOutput.appendChild(div);
        }

        function scrollToBottom() {
             const body = document.getElementById('terminal-body');
             body.scrollTop = body.scrollHeight;
        }

        // ================= 3. REAL TOOLS =================
        // Base64 Tool
        function doBase64(action) {
            const input = document.getElementById('crypto-input').value;
            const output = document.getElementById('crypto-output');
            try {
                if(action === 'encode') output.value = btoa(input);
                else output.value = atob(input);
                notify(action === 'encode' ? "Text Encoded" : "Text Decoded", "success");
            } catch(e) {
                output.value = "Error: Invalid Input";
                notify("Error processing text", "error");
            }
        }

        // Password Generator
        function generatePass() {
            const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()";
            let pass = "";
            for(let i=0; i<16; i++) {
                pass += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            document.getElementById('pass-output').value = pass;
            notify("New Password Generated", "success");
        }

        // News Loader
        function loadNews() {
            const news = [
                {title: "CVE-2024-3094 Found", desc: "Malicious backdoor in xz utils."},
                {title: "JKA5 Platform V6", desc: "New utility tools added for students."},
                {title: "Python Exploit Released", desc: "PoC available for latest Windows bug."}
            ];
            document.getElementById('news-feed').innerHTML = news.map(n => `
                <div style="margin-bottom:15px; border-bottom:1px dashed #444; padding-bottom:10px;">
                    <div style="color:#fff; font-weight:bold; margin-bottom:5px;">${n.title}</div>
                    <div style="font-size:12px; color:#999;">${n.desc}</div>
                </div>
            `).join('');
        }

        // ================= 4. MINIGAME =================
        const secretCode = Math.floor(Math.random() * 900) + 100; // 100-999
        function checkCode() {
            const guess = parseInt(document.getElementById('game-input').value);
            const msg = document.getElementById('game-msg');
            
            if(guess === secretCode) {
                msg.innerText = "ACCESS GRANTED!";
                msg.style.color = "var(--main-neon)";
                notify("Code Cracked!", "success");
            } else if (guess < secretCode) {
                msg.innerText = "TOO LOW (ÿ¨ÿ±ÿ® ÿ±ŸÇŸÖ ÿ£ŸÉÿ®ÿ±)";
                msg.style.color = "var(--alert)";
            } else {
                msg.innerText = "TOO HIGH (ÿ¨ÿ±ÿ® ÿ±ŸÇŸÖ ÿ£ÿµÿ∫ÿ±)";
                msg.style.color = "var(--alert)";
            }
        }

        // ================= 5. WINDOW MANAGER =================
        let zIndex = 100;
        function openWindow(id) {
            const win = document.getElementById(id);
            win.style.display = 'flex';
            zIndex++; win.style.zIndex = zIndex;
        }
        function closeWindow(id) { document.getElementById(id).style.display = 'none'; }
        
        function dragElement(elmnt) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            const header = elmnt.querySelector('.win-header');
            if(header) header.onmousedown = dragMouseDown;
            function dragMouseDown(e) {
                e.preventDefault(); pos3 = e.clientX; pos4 = e.clientY;
                document.onmouseup = closeDragElement; document.onmousemove = elementDrag;
                zIndex++; elmnt.style.zIndex = zIndex;
            }
            function elementDrag(e) {
                e.preventDefault(); pos1 = pos3 - e.clientX; pos2 = pos4 - e.clientY;
                pos3 = e.clientX; pos4 = e.clientY;
                elmnt.style.top = (elmnt.offsetTop - pos2) + "px"; elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
            }
            function closeDragElement() { document.onmouseup = null; document.onmousemove = null; }
        }

        // Matrix Background
        function startMatrix(color='#00ff41') {
            const c = document.getElementById("matrixCanvas");
            const ctx = c.getContext("2d");
            c.width = window.innerWidth; c.height = window.innerHeight;
            const chars = "01"; const drops = Array(Math.floor(c.width/20)).fill(1);
            setInterval(()=>{
                ctx.fillStyle="rgba(0,0,0,0.05)"; ctx.fillRect(0,0,c.width,c.height);
                ctx.fillStyle=color; ctx.font="15px monospace";
                drops.forEach((y,i)=>{
                    ctx.fillText(chars[Math.floor(Math.random()*2)],i*20,y*20);
                    if(y*20>c.height && Math.random()>0.975) drops[i]=0;
                    drops[i]++;
                });
            }, 50);
        }
    </script>
</body>
</html>
